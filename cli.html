<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Command line interface (CLI) &mdash; phenopacket-tools 0.4.7 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/ptools.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Constants" href="constants.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> phenopacket-tools
          </a>
              <div class="version">
                0.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating.html">Creating Phenopackets</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validating Phenopackets</a></li>
<li class="toctree-l1"><a class="reference internal" href="converting.html">Converting V1 Phenopackets</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Constants</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Command line interface (CLI)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setup">Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#download">Download</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-from-source-code">Build from source code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#commands">Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#examples-generate-examples-of-the-top-level-elements"><em>examples</em> - generate examples of the top-level elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convert-convert-top-level-elements-from-v1-to-v2-format"><em>convert</em> - convert top-level elements from <em>v1</em> to <em>v2</em> format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#validate-validate-semantic-and-syntactic-correctness"><em>validate</em> - validate semantic and syntactic correctness</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Usage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#set-up-autocompletion">Set up autocompletion</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">phenopacket-tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Command line interface (CLI)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cli.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="command-line-interface-cli">
<span id="rstcli"></span><h1>Command line interface (CLI)<a class="headerlink" href="#command-line-interface-cli" title="Permalink to this heading"></a></h1>
<p><em>phenopacket-tools</em> CLI provides functionality for viewing, conversion and validation
of the top-level elements of Phenopacket schema. This document describes how to set up the CLI application
on Linux, Mac and Windows environments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>phenopacket-tools</em> is written in Java 17 and requires Java 17 or newer to run.</p>
</div>
<p><em>phenopacket-tools</em> is distributed as a standalone executable Java Archive (JAR) file. The application requires
no special installation procedure if Java 17 or better is available in your environment.</p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading"></a></h2>
<p>Most users should <em>download</em> the distribution ZIP file with precompiled JAR file from <em>phenopacket-tools</em> release page.
However, it is also possible to <em>build</em> the JAR from sources.</p>
<section id="download">
<h3>Download<a class="headerlink" href="#download" title="Permalink to this heading"></a></h3>
<p><em>phenopacket-tools</em> JAR is provided in the distribution ZIP file as part of <em>phenopacket-tools</em>’ release schedule
from <a class="reference external" href="https://github.com/phenopackets/phenopacket-tools/releases">Releases</a>.</p>
<p>The ZIP archive contains the executable JAR file along with README and example phenopackets required to run the setup
and the tutorial.</p>
</section>
<section id="build-from-source-code">
<h3>Build from source code<a class="headerlink" href="#build-from-source-code" title="Permalink to this heading"></a></h3>
<p>The source code is available in our <a class="reference external" href="https://github.com/phenopackets/phenopacket-tools">GitHub repository</a>.
There are 2 requirements for building the app from sources:</p>
<ul class="simple">
<li><p><strong>Java Development Kit</strong> (JDK) 17 or newer must be present in the environment and <code class="docutils literal notranslate"><span class="pre">$JAVA_HOME</span></code> variable must point
to JDK’s location. See <a class="reference external" href="https://maven.apache.org/install.html">Installing Apache Maven</a> for more details regarding
setting up JDK and <code class="docutils literal notranslate"><span class="pre">$JAVA_HOME</span></code> on your system.</p></li>
<li><p><em>phenopacket-tools</em> leverages several open-source Java libraries and a <strong>working internet connection</strong>
is required to download the libraries.</p></li>
</ul>
<p>Run the following commands to check out the stable source code and to build the application:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/phenopackets/phenopacket-tools
$ cd phenopacket-tools
$ ./mvnw -Prelease package
</pre></div>
</div>
<p>After a successful build, a distribution ZIP file “phenopacket-tools-cli-0.4.7-distribution.zip”
will be created in the <code class="docutils literal notranslate"><span class="pre">phenopacket-tools-cli/target</span></code> directory. Use the ZIP archive in the same way as the archive
downloaded from <em>phenopacket-tools</em> releases.</p>
</section>
</section>
<section id="commands">
<h2>Commands<a class="headerlink" href="#commands" title="Permalink to this heading"></a></h2>
<p><em>phenopacket-tools</em> CLI provides the following commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">examples</span></code> - generate examples of the top-level elements</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">convert</span></code> - convert top-level elements from <em>v1</em> to <em>v2</em> format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">validate</span></code> - validate semantic and syntactic correctness of top-level Phenopacket schema elements</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">examples</span></code> command is fairly simple; it writes a bunch of example phenopackets, cohorts and families
into the provided directory. The <code class="docutils literal notranslate"><span class="pre">convert</span></code> and <code class="docutils literal notranslate"><span class="pre">validate</span></code> commands, despite being a bit more elaborate, work in
a similar manner. The parts shared by the both command are be described in greater detail
in the <code class="docutils literal notranslate"><span class="pre">convert</span></code> command section.</p>
<p>In the next sections, we will run <em>phenopacket-tools</em> by using the following alias:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ alias pxf=&quot;java -jar phenopacket-tools-cli-${project.version}.jar&quot;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The commands report warnings and errors by default. Use <cite>-v</cite> to increase the verbosity and see what’s
going on under the hood. The <cite>-v</cite> can be specified multiple times (e.g. <cite>-vvv</cite>).</p>
</div>
<section id="examples-generate-examples-of-the-top-level-elements">
<h3><em>examples</em> - generate examples of the top-level elements<a class="headerlink" href="#examples-generate-examples-of-the-top-level-elements" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">examples</span></code> command writes example phenopackets (including family and cohort examples) into
a provided base directory. Starting from a <cite>base</cite> directory, the examples are written into three sub-folders:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base</span>
<span class="o">|-</span> <span class="n">phenopackets</span>
<span class="o">|-</span> <span class="n">families</span>
\<span class="o">-</span> <span class="n">cohorts</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">examples</span></code> command requires an optional <code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">|</span> <span class="pre">--output</span></code> argument. By default, the examples will be placed
into the current directory.</p>
<p>The following command writes the examples into the <code class="docutils literal notranslate"><span class="pre">path/to/examples</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pxf examples -o path/to/examples
</pre></div>
</div>
</section>
<section id="convert-convert-top-level-elements-from-v1-to-v2-format">
<h3><em>convert</em> - convert top-level elements from <em>v1</em> to <em>v2</em> format<a class="headerlink" href="#convert-convert-top-level-elements-from-v1-to-v2-format" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">convert</span></code> command converts a phenopacket, family, or a cohort from <em>v1</em> to <em>v2</em> format of Phenopacket schema.</p>
<section id="usage">
<h4>Usage<a class="headerlink" href="#usage" title="Permalink to this heading"></a></h4>
<p>Let’s assume we have an example phenopacket <code class="docutils literal notranslate"><span class="pre">phenopacket.v1.json</span></code>, family <code class="docutils literal notranslate"><span class="pre">family.v1.json</span></code>,
and cohort <code class="docutils literal notranslate"><span class="pre">cohort.v1.json</span></code>.</p>
<p>We can convert a <em>v1</em> phenopacket into <em>v2</em> by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat phenopacket.v1.json | pxf convert &gt; phenopacket.v2.json
</pre></div>
</div>
<p><em>phenopacket-tools</em> makes an educated guess to determine if the input is in <em>JSON</em>, <em>Protobuf</em>, or <em>YAML</em> format.
The guessing is, however, naive and can fail in parsing e.g. gzipped <em>JSON</em> file. Turn of the format guessing
by providing the <code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">|</span> <span class="pre">--format</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ # Explicit JSON input
$ cat phenopacket.v1.json | pxf convert -f json &gt; phenopacket.v2.json
$
$ # Explicit protobuf input
$ cat phenopacket.v1.pb | pxf convert -f protobuf &gt; phenopacket.v2.pb
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">|</span> <span class="pre">--format</span></code> option accepts one of the following 3 values: <code class="docutils literal notranslate"><span class="pre">{json,</span> <span class="pre">pb,</span> <span class="pre">yaml}</span></code>.</p>
<p>By default, the output is written in the format of the input data.
However, we can override this by using <code class="docutils literal notranslate"><span class="pre">--output-format</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat phenopacket.v1.json | pxf convert --output-format pb &gt; phenopacket.v2.pb
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--output-format</span></code> option takes the same values as <code class="docutils literal notranslate"><span class="pre">--format</span></code>: <code class="docutils literal notranslate"><span class="pre">{json,</span> <span class="pre">pb,</span> <span class="pre">yaml}</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">convert</span></code> command expects to receive a phenopacket by default. However, it can also convert the other
top-level elements of the Phenopacket schema: family and cohort. Use the <code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">|</span> <span class="pre">--element</span></code> option to indicate if
the input is a <code class="docutils literal notranslate"><span class="pre">family</span></code> or a <code class="docutils literal notranslate"><span class="pre">cohort</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat family.v1.json | pxf convert -e family &gt; family.v2.json
$ cat cohort.v1.json | pxf convert -e cohort &gt; cohort.v2.json
</pre></div>
</div>
<p>We can convert one or more item at the time by using the <code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">|</span> <span class="pre">--input</span></code> option. If the <code class="docutils literal notranslate"><span class="pre">-i</span></code> option is used only once,
the STDIN is ignored and the conversion proceeds in the same way as in the examples above. However, <code class="docutils literal notranslate"><span class="pre">-i</span></code> option can
be provided more than once, to convert a collection of items in a single run. The results of the bulk processing
are written into a directory supplied via the <code class="docutils literal notranslate"><span class="pre">-O</span> <span class="pre">|</span> <span class="pre">--output-directory</span></code> option (the option is mandatory if using
&gt;1 <code class="docutils literal notranslate"><span class="pre">-i</span></code>).</p>
<p>For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pxf convert -i phenopacket.a.v1.json -i phenopacket.b.v1.json -O converted
</pre></div>
</div>
<p>converts the input phenopackets and stores the results in the <code class="docutils literal notranslate"><span class="pre">converted</span></code> folder. The converted files will be stored
under the same names.</p>
</section>
</section>
<section id="validate-validate-semantic-and-syntactic-correctness">
<h3><em>validate</em> - validate semantic and syntactic correctness<a class="headerlink" href="#validate-validate-semantic-and-syntactic-correctness" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">validate</span></code> command checks <em>syntactic</em> and <em>semantic</em> correctness of a <em>phenopacket</em>, <em>family</em>, or <em>cohort</em>.</p>
<p>Briefly, to be syntactically correct, a phenopacket must be well formatted (valid Protobuf message, JSON document, etc.)
and meet the requirements of the Phenopacket schema; all REQUIRED attributes are set  (e.g. <code class="docutils literal notranslate"><span class="pre">phenopacket.id</span></code> and
<code class="docutils literal notranslate"><span class="pre">phenopacket.meta_data</span></code>), and <code class="docutils literal notranslate"><span class="pre">MetaData</span></code> includes a <code class="docutils literal notranslate"><span class="pre">Resource</span></code> for all ontology concepts.</p>
<p>The <em>semantic</em> correctness ensures that the element, when taken as a whole, is … TODO - finish</p>
<section id="id1">
<h4>Usage<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">validate</span></code> command shares many CLI options with <code class="docutils literal notranslate"><span class="pre">convert</span></code>.</p>
<p>The same options are used to indicate the input formats and element types. The input can be provided through STDIN
as well as in bulk. The bulk processing makes sense especially if we e.g. load the HPO graph for each validation.</p>
<p>Results are written into STDOUT in CSV/TSV format. The CSV output has a header, each header line starts with <code class="docutils literal notranslate"><span class="pre">#</span></code> character.
The header contains phenopacket-tools version, date time of validation, and list of validators that were run.
A row with column names follows the header, and then the individual validation results.</p>
</section>
</section>
</section>
<section id="set-up-autocompletion">
<h2>Set up autocompletion<a class="headerlink" href="#set-up-autocompletion" title="Permalink to this heading"></a></h2>
<p>TODO - write</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="constants.html" class="btn btn-neutral float-left" title="Constants" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Daniel Danis, Peter Robinson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>